;;Shivgoraksh

[Variable: PaymentLV]
	
	Type: String

[#Menu: ExpressIntegrationExp]
	
	Add: Item: ERPNextPayment  : Call: ERPNextPayment
	
	[Function: ERPNextPayment]
		
		List Variable: PaymentLV

		12 : Delete File: "STPayment.xml"
		13 : Open File: "STPayment.xml" : Text : Write
		14 : Truncate File

		16 : Walk Collection: ERPNextPaymentColl
		18 : Call: PaymentXML
		152 : List Add: PaymentLV : $name : $name		
		155 : End Walk

		200 : Close Target File
		210 : SET : IMPORT File : "STPayment.xml" 	
		220 : Import : Vouchers : Yes

;		230 : If : Not $$ImportInfo:Errors > 0		
;		240 : 	Call : UpdatePaymentStatus:($$NumItems:PaymentLVColl)
;		241 : 	Call : ERPNextCancelPayment
;		242 : else
;		245 : Msg Box: "Error" : "Something Went Wrong, Please contact support"
;		250 : End If

		
[Collection: ERPNextPaymentColl]
	
	Export Header	: "Accept: application/json"
	Export Header	: "Accept-Charset: utf-8"
	Export Header	: "Authorization: " + "token " + @@AuthToken

	Data Source		: HTTP JSON : @@ERPNextHost + '/api/method/express_tally.send_tally.payments'
	RemoteRequest	: PaymentReq : UTF8
	JSON Object 	: ERPNextPayment
	JSON Object Path: "message:1"


	[Object: ERPNextPayment]

		Storage : name 			: String
		Storage : party			: String
		Storage : party_name	: String
		Storage : posting_date  : String
		Storage : paid_from		: String
		Storage : paid_to 		: String
		Storage : paid_amount 	: Number
		Storage : remarks 		: String
		Storage : payment_type 	: String
		Storage : naming_series	: String
		Storage : amended_from			: String
		
		collection : treferences : treferences
		
		[Object: treferences]
			
			Collection: references : references
			
		[Object: references]
			
			Storage: allocated_amount 	: Number
			Storage: reference_name 	: String
			Storage: naming_series : String
;
;		[Object: taxes]
;			
;			Storage: account_head	: String
;			Storage: tax_amount_after_discount_amount : Number

;; Request Report 

	[Report: PaymentReq]
		
		Form: PaymentReq
		
		[Form: PaymentReq]
			
			Part: PaymentReq
			Delete: XMLTag

			[Part: PaymentReq]
					
				Line: PaymentReq
				Scroll: Vertical

				[Line: PaymentReq]
					
					Field: PaymentReqBranch, PaymentReqSyncFrom
					;XMLTag: "request"
					
				[Field: PaymentReqBranch]
					
					XMLTag: "company"
					Set as: @@ERPNextBranch
					
				[Field: PaymentReqSyncFrom]
					
					XMLTag: "date"
					Set as: "2021-04-01" ; @@ERPNextLastSyncOn
					
;; End of Request Report



;; Master Success 

[Function: UpdatePaymentStatus]
	
	Parameter: processedIds : Number

	08 : If: ##processedIds > 0 
	10 : Walk Collection: UpdatePaymentColl
	20 : End Walk
	30 : End If
	40 : Delete File: "STPayment.xml"




[Collection: UpdatePaymentColl]
	
	Export Header	: "Accept: application/json"
	Export Header	: "Accept-Charset: utf-8"
	Export Header	: "Authorization: " + "token " + @@AuthToken

	Data Source	 : HTTP JSON: @@ERPNextHost + '/api/method/tally_integration.tally.customer_update'
	RemoteRequest : UpdatePaymentRep : UTF8

;; Status Report 

[Report: UpdatePaymentRep]
	
	Form: UpdatePaymentRep
	
	[Form: UpdatePaymentRep]
		
		Part: UpdatePaymentRep
		Delete: XMLTag

	[Part: UpdatePaymentRep]
		
		Line: UpdatePaymentRep
		Scroll: Vertical
		
	[Line: UpdatePaymentRep]
		
		Field: UpdatePaymentRep
		Explode: UpdatePaymentRepExp
		
			[Part: UpdatePaymentRepExp]
				
				Line: UpdatePaymentRepExp
				Repeat: UpdatePaymentRepExp : PaymentLVColl
				
				[Line: UpdatePaymentRepExp]
					
					Field: UpdatePaymentRepExp
					JSONTag: "data"
					
					[Field:UpdatePaymentRepExp]
						
						Set as: $PaymentLV
						XMLTag: "docname"
		
		[Field: UpdatePaymentRep]
			
			Set as: "Payment Entry"
			JSONTag: "request_type"
	
	[Collection: PaymentLVColl]
		
		Data Source: Variable: PaymentLV 

;;;; Purchase XMl

[Function: PaymentXML]

Variable: payment_type  : String : $payment_type

	10 : Do If: ##payment_type  = "Pay" : Call: XMLPayment
	20 : Do If: ##payment_type  = "Receive" : Call: XMLReceipt
	30 : Do If: ##payment_type  = "Internal Transfer" : Call: XMLContra

[System: Formula]
	
	ETPymtKey : if $$IsEmpty:$amended_from  or $amended_from = "null"  then $name else "AMD"+ $name


[Function: XMLPayment]
	
10		: Write File Line 	:'	    <TALLYMESSAGE xmlns:UDF="TallyUDF">'
15		: Write File Line 	:'	     <VOUCHER REMOTEID="'+@@ETPymtKey+'" VCHTYPE="'+@@PEVouchertype+'" ACTION="Create" OBJVIEW="Accounting Voucher View">'
20		: Write File Line 	:'	      <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
25		: Write File Line 	:'	      <NARRATION>'+$$Trim:$remarks+'</NARRATION>'
30		: Write File Line 	:'	      <PARTYLEDGERNAME>'+$$Trim:$paid_from+'</PARTYLEDGERNAME>'
35		: Write File Line 	:'	      <VOUCHERTYPENAME>'+@@PEVouchertype+'</VOUCHERTYPENAME>'
40		: Write File Line 	:'	      <VOUCHERNUMBER>'+$name+'</VOUCHERNUMBER>'
45		: Write File Line 	:'	      <PERSISTEDVIEW>Accounting Voucher View</PERSISTEDVIEW>'
50		: Write File Line 	:'	      <EFFECTIVEDATE>'+$$GetTallyDate:$posting_date+'</EFFECTIVEDATE>'
55		: Write File Line 	:'	      <HASCASHFLOW>Yes</HASCASHFLOW>'
60		: Write File Line 	:'	      <ISVATDUTYPAID>Yes</ISVATDUTYPAID>'
65		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
70		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_to+'</LEDGERNAME>'
75		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>Yes</ISDEEMEDPOSITIVE>'
80		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
85		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>Yes</ISLASTDEEMEDPOSITIVE>'
90		: Write File Line 	:'	       <AMOUNT>'+@@PEPartyAmount+'</AMOUNT>'
95		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PEPartyAmount+'</VATEXPAMOUNT>'
96		: Walk Collection: treferences
98		: Walk Collection: references
;99 : Log: $reference_name
100		: Write File Line 	:'	       <BILLALLOCATIONS.LIST>'
105		: Write File Line 	:'	        <NAME>'+$$String:$reference_name+'</NAME>'
110		: Write File Line 	:'	        <BILLTYPE>New Ref</BILLTYPE>'
115		: Write File Line 	:'	        <AMOUNT>'+$$String:@@PEAllocAmount+'</AMOUNT>'
120		: Write File Line 	:'	       </BILLALLOCATIONS.LIST>'
121		: End Walk
122		: End Walk
125		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
130		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
135		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_from+'</LEDGERNAME>'
140		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>No</ISDEEMEDPOSITIVE>'
145		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
150		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>No</ISLASTDEEMEDPOSITIVE>'
155		: Write File Line 	:'	       <AMOUNT>'+@@PECashAmount+'</AMOUNT>'
160		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PECashAmount+'</VATEXPAMOUNT>'
;165		: Write File Line 	:'	       <BANKALLOCATIONS.LIST>'
;170		: Write File Line 	:'	        <DATE>'++'</DATE>'
;175		: Write File Line 	:'	        <INSTRUMENTDATE>'++'</INSTRUMENTDATE>'
;180		: Write File Line 	:'	        <NAME>'++'</NAME>'
;185		: Write File Line 	:'	        <TRANSACTIONTYPE>'++'</TRANSACTIONTYPE>'
;190		: Write File Line 	:'	        <IFSCODE>'++'</IFSCODE>'
;195		: Write File Line 	:'	        <BANKNAME>'++'</BANKNAME>'
;200		: Write File Line 	:'	        <ACCOUNTNUMBER>'++'</ACCOUNTNUMBER>'
;205		: Write File Line 	:'	        <PAYMENTFAVOURING>'++'</PAYMENTFAVOURING>'
;210		: Write File Line 	:'	        <TRANSFERMODE>'++'</TRANSFERMODE>'
;215		: Write File Line 	:'	        <BANKID>'++'</BANKID>'
;220		: Write File Line 	:'	        <INSTRUMENTNUMBER>'++'</INSTRUMENTNUMBER>'
;225		: Write File Line 	:'	        <UNIQUEREFERENCENUMBER>'++'</UNIQUEREFERENCENUMBER>'
;230		: Write File Line 	:'	        <STATUS>No</STATUS>'
;235		: Write File Line 	:'	        <PAYMENTMODE>Transacted</PAYMENTMODE>'
;240		: Write File Line 	:'	        <BANKPARTYNAME>'++'</BANKPARTYNAME>'
;245		: Write File Line 	:'	        <AMOUNT>'++'</AMOUNT>'
;250		: Write File Line 	:'	       </BANKALLOCATIONS.LIST>'
255		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
260		: Write File Line 	:'	     </VOUCHER>'
265		: Write File Line 	:'	    </TALLYMESSAGE>'


[Function: XMLReceipt]

10		: Write File Line 	:'	    <TALLYMESSAGE xmlns:UDF="TallyUDF">'
15		: Write File Line 	:'	     <VOUCHER REMOTEID="'+@@ETPymtKey+'" VCHTYPE="'+@@PEVouchertype+'" ACTION="Create" OBJVIEW="Accounting Voucher View">'
20		: Write File Line 	:'	      <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
25		: Write File Line 	:'	      <NARRATION>'+$$Trim:$remarks+'</NARRATION>'
30		: Write File Line 	:'	      <PARTYLEDGERNAME>'+$$Trim:$paid_from+'</PARTYLEDGERNAME>'
35		: Write File Line 	:'	      <VOUCHERTYPENAME>'+@@PEVouchertype+'</VOUCHERTYPENAME>'
40		: Write File Line 	:'	      <VOUCHERNUMBER>'+$name+'</VOUCHERNUMBER>'
45		: Write File Line 	:'	      <PERSISTEDVIEW>Accounting Voucher View</PERSISTEDVIEW>'
50		: Write File Line 	:'	      <EFFECTIVEDATE>'+$$GetTallyDate:$posting_date+'</EFFECTIVEDATE>'
55		: Write File Line 	:'	      <HASCASHFLOW>Yes</HASCASHFLOW>'
60		: Write File Line 	:'	      <ISVATDUTYPAID>Yes</ISVATDUTYPAID>'
65		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
70		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_from+'</LEDGERNAME>'
75		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>No</ISDEEMEDPOSITIVE>'
80		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
85		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>No</ISLASTDEEMEDPOSITIVE>'
90		: Write File Line 	:'	       <AMOUNT>'+@@PEPartyAmount+'</AMOUNT>'
95		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PEPartyAmount+'</VATEXPAMOUNT>'
96		: Walk Collection: treferences
98		: Walk Collection: references
100		: Write File Line 	:'	       <BILLALLOCATIONS.LIST>'
105		: Write File Line 	:'	        <NAME>'+$$String:$reference_name+'</NAME>'
110		: Write File Line 	:'	        <BILLTYPE>New Ref</BILLTYPE>'
115		: Write File Line 	:'	        <AMOUNT>'+$$String:$allocated_amount+'</AMOUNT>'
120		: Write File Line 	:'	       </BILLALLOCATIONS.LIST>'
121		: End Walk
122		: End Walk
125		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
130		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
135		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_to+'</LEDGERNAME>'
140		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>Yes</ISDEEMEDPOSITIVE>'
145		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
150		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>Yes</ISLASTDEEMEDPOSITIVE>'
155		: Write File Line 	:'	       <AMOUNT>'+@@PECashAmount+'</AMOUNT>'
160		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PECashAmount+'</VATEXPAMOUNT>'
162	: If: $$IsLedOfGrp:$paid_to:$$GroupBank or $$IsLedOfGrp:$paid_to:$$GroupBankOD
165		: Write File Line 	:'	       <BANKALLOCATIONS.LIST>'
170		: Write File Line 	:'	        <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
175		: Write File Line 	:'	        <INSTRUMENTDATE>'+$$GetTallyDate:$posting_date+'</INSTRUMENTDATE>'
180		: Write File Line 	:'	        <NAME>'+$name+'</NAME>'
185		: Write File Line 	:'	        <TRANSACTIONTYPE>Inter Bank Transfer</TRANSACTIONTYPE>'
190		: Write File Line 	:'	        <IFSCODE>'++'</IFSCODE>'
195		: Write File Line 	:'	        <BANKNAME>'++'</BANKNAME>'
200		: Write File Line 	:'	        <ACCOUNTNUMBER>'++'</ACCOUNTNUMBER>'
205		: Write File Line 	:'	        <PAYMENTFAVOURING>'+@@CMPMailName+'</PAYMENTFAVOURING>'
210		: Write File Line 	:'	        <TRANSFERMODE>RTGS</TRANSFERMODE>'
;215		: Write File Line 	:'	        <BANKID>'++'</BANKID>'
220		: Write File Line 	:'	        <INSTRUMENTNUMBER>'++'</INSTRUMENTNUMBER>'
225		: Write File Line 	:'	        <UNIQUEREFERENCENUMBER>'+$name+'</UNIQUEREFERENCENUMBER>'
230		: Write File Line 	:'	        <STATUS>No</STATUS>'
235		: Write File Line 	:'	        <PAYMENTMODE>Transacted</PAYMENTMODE>'
240		: Write File Line 	:'	        <BANKPARTYNAME>'++'</BANKPARTYNAME>'
245		: Write File Line 	:'	        <AMOUNT>'+@@PECashAmount+'</AMOUNT>'
250		: Write File Line 	:'	       </BANKALLOCATIONS.LIST>'
251 : End If 
255		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
260		: Write File Line 	:'	     </VOUCHER>'
265		: Write File Line 	:'	    </TALLYMESSAGE>'


[Function: XMLContra]

10		: Write File Line 	:'	    <TALLYMESSAGE xmlns:UDF="TallyUDF">'
15		: Write File Line 	:'	     <VOUCHER REMOTEID="'+$name+'" VCHTYPE="'+@@PEVouchertype+'" ACTION="Create" OBJVIEW="Accounting Voucher View">'
20		: Write File Line 	:'	      <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
25		: Write File Line 	:'	      <NARRATION>'+$$Trim:$remarks+'</NARRATION>'
30		: Write File Line 	:'	      <PARTYLEDGERNAME>'+$$Trim:$paid_from+'</PARTYLEDGERNAME>'
35		: Write File Line 	:'	      <VOUCHERTYPENAME>'+@@PEVouchertype+'</VOUCHERTYPENAME>'
40		: Write File Line 	:'	      <VOUCHERNUMBER>'+$name+'</VOUCHERNUMBER>'
45		: Write File Line 	:'	      <PERSISTEDVIEW>Accounting Voucher View</PERSISTEDVIEW>'
50		: Write File Line 	:'	      <EFFECTIVEDATE>'+$$GetTallyDate:$posting_date+'</EFFECTIVEDATE>'
55		: Write File Line 	:'	      <HASCASHFLOW>Yes</HASCASHFLOW>'
60		: Write File Line 	:'	      <ISVATDUTYPAID>Yes</ISVATDUTYPAID>'
65		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
70		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_from+'</LEDGERNAME>'
75		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>No</ISDEEMEDPOSITIVE>'
80		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
85		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>No</ISLASTDEEMEDPOSITIVE>'
90		: Write File Line 	:'	       <AMOUNT>'+@@PEPartyAmount+'</AMOUNT>'
95		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PEPartyAmount+'</VATEXPAMOUNT>'

96	: If: $$IsLedOfGrp:$paid_from:$$GroupBank or $$IsLedOfGrp:$paid_from:$$GroupBankOD
97		: Write File Line 	:'	       <BANKALLOCATIONS.LIST>'
98		: Write File Line 	:'	        <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
99		: Write File Line 	:'	        <INSTRUMENTDATE>'+$$GetTallyDate:$posting_date+'</INSTRUMENTDATE>'
100		: Write File Line 	:'	        <NAME>cr'+$name+'</NAME>'
101		: Write File Line 	:'	        <TRANSACTIONTYPE>Inter Bank Transfer</TRANSACTIONTYPE>'
102		: Write File Line 	:'	        <IFSCODE>'++'</IFSCODE>'
103		: Write File Line 	:'	        <BANKNAME>'++'</BANKNAME>'
104		: Write File Line 	:'	        <ACCOUNTNUMBER>'++'</ACCOUNTNUMBER>'
105		: Write File Line 	:'	        <PAYMENTFAVOURING>'+@@CMPMailName+'</PAYMENTFAVOURING>'
106		: Write File Line 	:'	        <TRANSFERMODE>RTGS</TRANSFERMODE>'
;215		: Write File Line 	:'	        <BANKID>'++'</BANKID>'
108		: Write File Line 	:'	        <INSTRUMENTNUMBER>'++'</INSTRUMENTNUMBER>'
109		: Write File Line 	:'	        <UNIQUEREFERENCENUMBER>cr'+$name+'</UNIQUEREFERENCENUMBER>'
110		: Write File Line 	:'	        <STATUS>No</STATUS>'
111		: Write File Line 	:'	        <PAYMENTMODE>Transacted</PAYMENTMODE>'
112		: Write File Line 	:'	        <BANKPARTYNAME>'++'</BANKPARTYNAME>'
113		: Write File Line 	:'	        <AMOUNT>'+@@PEPartyAmount+'</AMOUNT>'
114		: Write File Line 	:'	       </BANKALLOCATIONS.LIST>'
115 : End If 

125		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
130		: Write File Line 	:'	      <ALLLEDGERENTRIES.LIST>'
135		: Write File Line 	:'	       <LEDGERNAME>'+$$TRIM_Abbr:$paid_to+'</LEDGERNAME>'
140		: Write File Line 	:'	       <ISDEEMEDPOSITIVE>Yes</ISDEEMEDPOSITIVE>'
145		: Write File Line 	:'	       <ISPARTYLEDGER>Yes</ISPARTYLEDGER>'
150		: Write File Line 	:'	       <ISLASTDEEMEDPOSITIVE>Yes</ISLASTDEEMEDPOSITIVE>'
155		: Write File Line 	:'	       <AMOUNT>'+@@PECashAmount+'</AMOUNT>'
160		: Write File Line 	:'	       <VATEXPAMOUNT>'+@@PECashAmount+'</VATEXPAMOUNT>'
162	: If: $$IsLedOfGrp:$paid_to:$$GroupBank or $$IsLedOfGrp:$paid_to:$$GroupBankOD
165		: Write File Line 	:'	       <BANKALLOCATIONS.LIST>'
170		: Write File Line 	:'	        <DATE>'+$$GetTallyDate:$posting_date+'</DATE>'
175		: Write File Line 	:'	        <INSTRUMENTDATE>'+$$GetTallyDate:$posting_date+'</INSTRUMENTDATE>'
180		: Write File Line 	:'	        <NAME>'+$name+'</NAME>'
185		: Write File Line 	:'	        <TRANSACTIONTYPE>Inter Bank Transfer</TRANSACTIONTYPE>'
190		: Write File Line 	:'	        <IFSCODE>'++'</IFSCODE>'
195		: Write File Line 	:'	        <BANKNAME>'++'</BANKNAME>'
200		: Write File Line 	:'	        <ACCOUNTNUMBER>'++'</ACCOUNTNUMBER>'
205		: Write File Line 	:'	        <PAYMENTFAVOURING>'+@@CMPMailName+'</PAYMENTFAVOURING>'
210		: Write File Line 	:'	        <TRANSFERMODE>RTGS</TRANSFERMODE>'
;215		: Write File Line 	:'	        <BANKID>'++'</BANKID>'
220		: Write File Line 	:'	        <INSTRUMENTNUMBER>'++'</INSTRUMENTNUMBER>'
225		: Write File Line 	:'	        <UNIQUEREFERENCENUMBER>'+$name+'</UNIQUEREFERENCENUMBER>'
230		: Write File Line 	:'	        <STATUS>No</STATUS>'
235		: Write File Line 	:'	        <PAYMENTMODE>Transacted</PAYMENTMODE>'
240		: Write File Line 	:'	        <BANKPARTYNAME>'++'</BANKPARTYNAME>'
245		: Write File Line 	:'	        <AMOUNT>'+@@PECashAmount+'</AMOUNT>'
250		: Write File Line 	:'	       </BANKALLOCATIONS.LIST>'
251 : End If 
255		: Write File Line 	:'	      </ALLLEDGERENTRIES.LIST>'
260		: Write File Line 	:'	     </VOUCHER>'
265		: Write File Line 	:'	    </TALLYMESSAGE>'

[System : Formula]

	PEVoucherType 	: $$GetVchTypeByNaming:$naming_series ; if ##payment_type = "Pay" then $$GEOPymtVchType else if ##payment_type = "Receive" then $$GEORcptVchType else "ERPNext Contra"
;	PENamingSeries	: $treferences[1].name

	PEPartyAmount	: if ##payment_type = "Pay" then '-'+$$String:@@PEAbsPartyAmount else $$String:@@PEAbsPartyAmount
	PEAbsPartyAmount	: $$Abs:$paid_amount
	
	PEAllocAmount	: if ##payment_type = "Pay" then '-'+$$String:@@PEAbsAllocAmount else $$String:@@PEAbsAllocAmount
	PEAbsAllocAmount	: $$Abs:$allocated_amount

	PECashAmount	: if ##payment_type = "Pay" then $$String:@@PEAbsCashAmount else '-'+$$String:@@PEAbsCashAmount
	PEAbsCashAmount	: $$Abs:$paid_amount




	[Function: GEOPymtVchType]
				
;		10 : Do If: @@ERPNextBranch = "Andhra Pradesh"  	: Return: "Payment-AP"
;		20 : Do If: @@ERPNextBranch = "Pune"  				: Return: "Payment-PU"
;		25 : Do If: @@ERPNextBranch = "Odisha"  			: Return: "Payment-OD"
;		30 : Do If: @@ERPNextBranch = "Karnataka Factory"  	: Return: "Payment-KF"
;		35 : Do If: @@ERPNextBranch = "Punjab"  			: Return: "Payment-PB"
;		40 : Do If: @@ERPNextBranch = "Uttar Pradesh"  		: Return: "Payment-UP"
;		45 : Do If: @@ERPNextBranch = "Gujarat"  			: Return: "Payment-GJ"
;		50 : Do If: @@ERPNextBranch = "Haryana"  			: Return: "Payment-HA"
;		55 : Do If: @@ERPNextBranch = "Karnataka"  			: Return: "Payment-KA"
;		60 : Do If: @@ERPNextBranch = "Uttarakhand"  		: Return: "Payment-UK"
;		65 : Do If: @@ERPNextBranch = "Chhattisgarh"  		: Return: "Payment-CH"
;		70 : Do If: @@ERPNextBranch = "Rajasthan"  			: Return: "Payment-RJ"
;		75 : Do If: @@ERPNextBranch = "Telangana"  			: Return: "Payment-TL"
;		80 : Do If: @@ERPNextBranch = "Tamil Nadu"  		: Return: "Payment-TN"
;		85 : Do If: @@ERPNextBranch = "Madhya Pradesh"  	: Return: "Payment-MP"
;		90 : Do If: @@ERPNextBranch = "West Bengal"  		: Return: "Payment-WB"
;		95 : Do If: @@ERPNextBranch = "Maharashtra"  		: Return: "Payment-MH"
;		100 : Do If: @@ERPNextBranch = "Head Office"  		: Return: "Payment-HO"
;		105 : Do If: @@ERPNextBranch = "Factory"  			: Return: "Payment-FA"
;		110 : Do If: @@ERPNextBranch = "India"  				: Return: "Payment-IN"
;		115 : Do If: @@ERPNextBranch = "Bihar"  				: Return: "Payment-BI"
;		120 : Do If: @@ERPNextBranch = "Amazon"  			: Return: "Payment-AM"

		3000 : Return: "ERPNext Payment"


	[Function: GEORcptVchType]
				
;		10 : Do If: @@ERPNextBranch = "Andhra Pradesh"  	: Return: "Receipt-AP"
;		20 : Do If: @@ERPNextBranch = "Pune"  				: Return: "Receipt-PU"
;		25 : Do If: @@ERPNextBranch = "Odisha"  			: Return: "Receipt-OD"
;		30 : Do If: @@ERPNextBranch = "Karnataka Factory"  	: Return: "Receipt-KF"
;		35 : Do If: @@ERPNextBranch = "Punjab"  			: Return: "Receipt-PB"
;		40 : Do If: @@ERPNextBranch = "Uttar Pradesh"  		: Return: "Receipt-UP"
;		45 : Do If: @@ERPNextBranch = "Gujarat"  			: Return: "Receipt-GJ"
;		50 : Do If: @@ERPNextBranch = "Haryana"  			: Return: "Receipt-HA"
;		55 : Do If: @@ERPNextBranch = "Karnataka"  			: Return: "Receipt-KA"
;		60 : Do If: @@ERPNextBranch = "Uttarakhand"  		: Return: "Receipt-UK"
;		65 : Do If: @@ERPNextBranch = "Chhattisgarh"  		: Return: "Receipt-CH"
;		70 : Do If: @@ERPNextBranch = "Rajasthan"  			: Return: "Receipt-RJ"
;		75 : Do If: @@ERPNextBranch = "Telangana"  			: Return: "Receipt-TL"
;		80 : Do If: @@ERPNextBranch = "Tamil Nadu"  		: Return: "Receipt-TN"
;		85 : Do If: @@ERPNextBranch = "Madhya Pradesh"  	: Return: "Receipt-MP"
;		90 : Do If: @@ERPNextBranch = "West Bengal"  		: Return: "Receipt-WB"
;		95 : Do If: @@ERPNextBranch = "Maharashtra"  		: Return: "Receipt-MH"
;		100 : Do If: @@ERPNextBranch = "Head Office"  		: Return: "Receipt-HO"
;		105 : Do If: @@ERPNextBranch = "Factory"  			: Return: "Receipt-FA"
;		110 : Do If: @@ERPNextBranch = "India"  			: Return: "Receipt-IN"
;		115 : Do If: @@ERPNextBranch = "Bihar"  			: Return: "Receipt-BI"
;		120 : Do If: @@ERPNextBranch = "Amazon"  			: Return: "Receipt-AM"

		3000 : Return: "ERPNext Receipt"


;[Function: CreateAccountHead]
;	
;	Parameter: vName : String
;
;	10 : New Object: Ledger
;	20 : 	Set Value: NAme : ##vName
;	30 : 	Set Value: Parent : "Duties and Taxes"
;	40 : Create Target
;	
;
;[Function: CreateItems]
;	
;	Parameter: vName : String
;	Parameter: vGroup : String
;	Parameter: vUnits : String
;	
;	08 : Do If: ($$IsEmpty:$Name:StockGroup:##vGroup) : Call: CreateStockGroup:##vGroup
;	09 : Do If: ($$IsEmpty:$Name:Unit:##vUnits) : Call: CreateUnits:##vUnits
;
;	10 : New Object: StockItem 
;	20 : 	Set Value: Name 	: ##vName
;	30 : 	Set Value: Parent 	: ##vGroup
;	40 : 	Set Value: BaseUnits : ##vUnits
;	50 : Create Target
;
;
;
;[Function: CreateStockGroup]
;		
;	Parameter: vGroup : String
;	
;	10 : New Object: StockGroup
;	20 : 	Set Value: Name : ##vGroup 
;	30 : Create Target
;
;	
;	
;[Function: CreateUnits]
;
;	Parameter : vUnit : String
;
;	10 : New Object: Unit
;	30 : 	Set Value: Name : ##vUnit
;	40 : 	Set Value: ASORIGINAL : Yes
;	50 : 	Set Value: ISSIMPLEUNIT : Yes
;	60 : Create Target
;	
;
;[Function: CreateWarehouse]
;
;	Parameter : vName : String
;
;	10 : New Object: Godown
;	30 : 	Set Value: Name : ##vName
;	40 : 	Set Value: ASORIGINAL : Yes
;	60 : Create Target
;



